(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{104:function(e,t,a){},127:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(8),c=a.n(o);a(104),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var r,l,d=a(79),s=a.n(d),u=a(170),m=a(171),f=a(172),p=a(162),b=a(129),g=a(166),E=a(174),h=a(175),y=a(173),k=a(180),v=a(177),C=a(12),j=a(17),O=a(81),I={withCredentials:!0,headers:{"API-KEY":"199df811-bd09-48a1-81bc-ca38857c74a2"}},T=a.n(O).a.create(Object(j.a)({baseURL:"https://social-network.samuraijs.com/api/1.1/"},I));!function(e){e[e.New=0]="New",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed",e[e.Draft=3]="Draft"}(r||(r={})),function(e){e[e.Low=0]="Low",e[e.Middle=1]="Middle",e[e.High=2]="High",e[e.Urgent=3]="Urgent",e[e.Later=4]="Later"}(l||(l={}));var S=function(){return T.get("todo-lists")},A=function(e){return T.post("todo-lists",{title:e})},L=function(e,t){return T.put("todo-lists/".concat(e),{title:t})},w=function(e){return T.delete("todo-lists/".concat(e))},x=function(e){return T.get("todo-lists/".concat(e,"/tasks"))},P=function(e,t){return T.post("todo-lists/".concat(e,"/tasks"),{title:t})},F=function(e,t,a){return T.put("todo-lists/".concat(e,"/tasks/").concat(t),a)},N=function(e,t){return T.delete("todo-lists/".concat(e,"/tasks/").concat(t))},z=function(){return T.get("auth/me")},D=function(e){return T.post("auth/login",e)},R=function(){return T.delete("auth/login")},_=function(e,t){e.messages.length?t($(e.messages[0])):t($("Some error occurred")),t(W("failed"))},M=function(e,t){t($(e.message)),t(W("failed"))},U=a(25),q=Object(U.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(e,t){e.isLoggedIn=t.payload}}}),B=q.reducer,H=q.actions.setIsLoggedInAC,J=Object(U.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setAppStatusAC:function(e,t){e.status=t.payload},setAppErrorAC:function(e,t){e.error=t.payload},setIsInitializedAC:function(e,t){e.isInitialized=t.payload}}}),K=J.reducer,Z=J.actions,W=Z.setAppStatusAC,$=Z.setAppErrorAC,G=Z.setIsInitializedAC;function Q(e){return i.a.createElement(v.a,Object.assign({elevation:6,variant:"filled"},e))}function V(){var e=Object(C.c)((function(e){return e.app.error})),t=Object(C.b)(),a=function(e,a){"clickaway"!==a&&t($(null))};return i.a.createElement(k.a,{open:null!==e,autoHideDuration:6e3,onClose:a},i.a.createElement(Q,{onClose:a,severity:"error"},e))}var Y=Object(U.b)({name:"todoLists",initialState:[],reducers:{removeTodoListAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload}));a>-1&&e.splice(a,1)},addTodoListAC:function(e,t){e.unshift(Object(j.a)(Object(j.a)({},t.payload),{},{filter:"all",entityStatus:"succeeded"}))},changeTodoListTitleAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.todoListId}));e[a].title=t.payload.title},changeTodoListFilterAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.todoListId}));e[a].filter=t.payload.filter},setTodolistsAC:function(e,t){return t.payload.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{filter:"all",entityStatus:"succeeded"})}))},changeTodolistEntityStatusAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].entityStatus=t.payload.entityStatus}}}),X=Y.reducer,ee=Y.actions,te=ee.removeTodoListAC,ae=ee.addTodoListAC,ne=ee.changeTodoListTitleAC,ie=ee.changeTodoListFilterAC,oe=ee.setTodolistsAC,ce=ee.changeTodolistEntityStatusAC,re=a(167),le=a(128),de=a(45),se=a(176),ue=a(164),me=i.a.memo((function(e){console.log("AddItemForm is called");var t=Object(C.c)((function(e){return e.app.status})),a=Object(n.useState)(""),o=Object(de.a)(a,2),c=o[0],r=o[1],l=Object(n.useState)(null),d=Object(de.a)(l,2),s=d[0],u=d[1],m=function(){c.trim()?(e.addItem(c.trim()),"succeeded"===t&&r("")):u("Title is required")};return i.a.createElement("div",null,i.a.createElement(se.a,{variant:"outlined",value:c,onChange:function(e){r(e.currentTarget.value)},onKeyPress:function(e){null!==s&&u(null),"Enter"===e.key&&m()},error:!!s,label:"Title",helperText:s,disabled:e.disabled}),i.a.createElement(p.a,{color:"primary",onClick:m,disabled:e.disabled},i.a.createElement(ue.a,null)))})),fe=i.a.memo((function(e){console.log("EditableSpan is called");var t=Object(C.c)((function(e){return e.app.status})),a=Object(n.useState)(!1),o=Object(de.a)(a,2),c=o[0],r=o[1],l=Object(n.useState)(e.title),d=Object(de.a)(l,2),s=d[0],u=d[1];return c?i.a.createElement(se.a,{value:s,autoFocus:!0,onBlur:function(){s.trim()&&e.changeTitle(s.trim()),"succeeded"===t&&r(!1)},onChange:function(e){u(e.currentTarget.value)},onKeyPress:function(a){"Enter"===a.key&&(s.trim()&&e.changeTitle(s.trim()),"succeeded"===t&&r(!1))}}):i.a.createElement("span",{onDoubleClick:function(){!e.disabled&&r(!0)}},e.title)})),pe=a(165),be=Object(U.b)({name:"tasks",initialState:{},reducers:{removeTaskAC:function(e,t){var a=e[t.payload.todoListId],n=a.findIndex((function(e){return e.id===t.payload.taskId}));n>-1&&a.splice(n,1)},addTaskAC:function(e,t){e[t.payload.todoListId].unshift(Object(j.a)(Object(j.a)({},t.payload),{},{entityStatus:"succeeded"}))},updateTaskAC:function(e,t){var a=e[t.payload.todoListId],n=a.findIndex((function(e){return e.id===t.payload.taskId}));n>-1&&(a[n]=Object(j.a)(Object(j.a)({},a[n]),t.payload.model))},setTasksAC:function(e,t){e[t.payload.todolistId]=t.payload.tasks.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{entityStatus:"succeeded"})}))},changeTaskEntityStatusAC:function(e,t){var a=e[t.payload.todolistId],n=a.findIndex((function(e){return e.id===t.payload.taskId}));n>-1&&(a[n]=Object(j.a)(Object(j.a)({},a[n]),{},{entityStatus:t.payload.entityStatus}))}},extraReducers:function(e){e.addCase(ae,(function(e,t){e[t.payload.id]=[]})),e.addCase(te,(function(e,t){delete e[t.payload]})),e.addCase(oe,(function(e,t){t.payload.forEach((function(t){e[t.id]=[]}))}))}}),ge=be.reducer,Ee=be.actions,he=Ee.removeTaskAC,ye=Ee.addTaskAC,ke=Ee.updateTaskAC,ve=Ee.setTasksAC,Ce=Ee.changeTaskEntityStatusAC,je=function(e,t,a){return function(n,i){var o=i().tasks[a].find((function(t){return t.id===e}));if(o){var c=Object(j.a)({deadline:o.deadline,description:o.description,priority:o.priority,startDate:o.startDate,status:o.status,title:o.title},t);n(W("loading")),n(Ce({taskId:e,todolistId:a,entityStatus:"loading"})),F(a,e,c).then((function(i){0===i.data.resultCode?(n(ke({taskId:e,model:t,todoListId:a})),n(W("succeeded")),n(Ce({taskId:e,todolistId:a,entityStatus:"succeeded"}))):(_(i.data,n),n(Ce({taskId:e,todolistId:a,entityStatus:"failed"})))})).catch((function(t){M(t,n),n(Ce({taskId:e,todolistId:a,entityStatus:"failed"}))}))}}},Oe=a(178),Ie=i.a.memo((function(e){var t=Object(n.useCallback)((function(){e.removeTask(e.task.id)}),[e.removeTask,e.task.id]),a=Object(n.useCallback)((function(t){e.changeTaskStatus(e.task.id,t.currentTarget.checked?r.Completed:r.New)}),[e.changeTaskStatus,e.task.id]),o=Object(n.useCallback)((function(t){e.changeTaskTitle(e.task.id,t)}),[e.changeTaskTitle,e.task.id]);return i.a.createElement("li",{key:e.task.id,className:e.task.status===r.Completed?"is-done":""},i.a.createElement(Oe.a,{onChange:a,checked:e.task.status===r.Completed,color:"primary",disabled:"loading"===e.task.entityStatus}),i.a.createElement(fe,{title:e.task.title,changeTitle:o,disabled:"loading"===e.task.entityStatus}),i.a.createElement(p.a,{onClick:t,disabled:"loading"===e.task.entityStatus},i.a.createElement(pe.a,null)))})),Te=i.a.memo((function(e){var t=e.todolist,a=e.demo,o=void 0!==a&&a;console.log("TodoList is called");var c=Object(C.b)();Object(n.useEffect)((function(){var e;o||c((e=t.id,function(t){t(W("loading")),x(e).then((function(a){var n=a.data.items;t(ve({tasks:n,todolistId:e})),t(W("succeeded"))})).catch((function(e){M(e,t)}))}))}),[]);var l=Object(C.c)((function(e){return e.tasks[t.id]})),d=l;"completed"===t.filter&&(d=l.filter((function(e){return e.status===r.Completed}))),"active"===t.filter&&(d=l.filter((function(e){return e.status===r.New})));var s=Object(n.useCallback)((function(e){c(function(e,t){return function(a){a(W("loading")),P(t,e).then((function(e){if(0===e.data.resultCode){var t=e.data.data.item;a(ye(t)),a(W("succeeded"))}else _(e.data,a)})).catch((function(e){M(e,a)}))}}(e,t.id))}),[c,t.id]),u=Object(n.useCallback)((function(e){c(function(e,t){return function(a){a(W("loading")),a(ce({id:e,entityStatus:"loading"})),L(e,t).then((function(n){0===n.data.resultCode?(a(ne({todoListId:e,title:t})),a(W("succeeded")),a(ce({id:e,entityStatus:"succeeded"}))):(_(n.data,a),a(ce({id:e,entityStatus:"failed"})))})).catch((function(t){M(t,a),a(ce({id:e,entityStatus:"failed"}))}))}}(t.id,e))}),[c,t.id]),m=Object(n.useCallback)((function(){var e;c((e=t.id,function(t){t(W("loading")),t(ce({id:e,entityStatus:"loading"})),w(e).then((function(a){0===a.data.resultCode?(t(te(e)),t(W("succeeded"))):_(a.data,t)})).catch((function(e){M(e,t)}))}))}),[c,t.id]),f=Object(n.useCallback)((function(){c(ie({todoListId:t.id,filter:"all"}))}),[c,t.id]),b=Object(n.useCallback)((function(){c(ie({todoListId:t.id,filter:"active"}))}),[c,t.id]),E=Object(n.useCallback)((function(){c(ie({todoListId:t.id,filter:"completed"}))}),[c,t.id]),h=Object(n.useCallback)((function(e){c(function(e,t){return function(a){a(W("loading")),a(Ce({taskId:e,todolistId:t,entityStatus:"loading"})),N(t,e).then((function(n){0===n.data.resultCode?(a(he({taskId:e,todoListId:t})),a(W("succeeded"))):_(n.data,a)})).catch((function(e){M(e,a)}))}}(e,t.id))}),[c,t.id]),y=Object(n.useCallback)((function(e,a){c(je(e,{status:a},t.id))}),[c,t.id]),k=Object(n.useCallback)((function(e,a){c(je(e,{title:a},t.id))}),[c,t.id]);return i.a.createElement("div",null,i.a.createElement("h3",null,i.a.createElement(fe,{title:t.title,changeTitle:u,disabled:"loading"===t.entityStatus}),i.a.createElement(p.a,{onClick:m,disabled:"loading"===t.entityStatus},i.a.createElement(pe.a,null))),i.a.createElement(me,{addItem:s,disabled:"loading"===t.entityStatus}),i.a.createElement("ul",{style:{listStyle:"none",padding:"0"}},d.map((function(e){return i.a.createElement(Ie,{key:e.id,removeTask:h,changeTaskStatus:y,changeTaskTitle:k,task:e})}))),i.a.createElement("div",null,i.a.createElement(g.a,{style:{margin:"3px"},size:"small",variant:"all"===t.filter?"contained":"outlined",color:"primary",onClick:f},"All"),i.a.createElement(g.a,{style:{margin:"3px"},size:"small",variant:"active"===t.filter?"contained":"outlined",color:"primary",onClick:b},"Active"),i.a.createElement(g.a,{style:{margin:"3px"},size:"small",variant:"completed"===t.filter?"contained":"outlined",color:"primary",onClick:E},"Completed")))})),Se=a(13),Ae=i.a.memo((function(e){var t=e.demo,a=void 0!==t&&t,o=Object(C.c)((function(e){return e.auth.isLoggedIn}));Object(n.useEffect)((function(){!a&&o&&r((function(e){e(W("loading")),S().then((function(t){e(oe(t.data)),e(W("succeeded"))})).catch((function(t){M(t,e)}))}))}),[]);var c=Object(C.c)((function(e){return e.todoLists})),r=Object(C.b)(),l=Object(n.useCallback)((function(e){r(function(e){return function(t){t(W("loading")),A(e).then((function(e){if(0===e.data.resultCode){var a=e.data.data.item;t(ae(a)),t(W("succeeded"))}else _(e.data,t)})).catch((function(e){M(e,t)}))}}(e))}),[r]);return o?i.a.createElement(i.a.Fragment,null,i.a.createElement(re.a,{container:!0,style:{padding:"15px"}},i.a.createElement(me,{addItem:l})),i.a.createElement(re.a,{container:!0,spacing:4},c.map((function(e){return i.a.createElement(re.a,{item:!0,key:e.id},i.a.createElement(le.a,{elevation:5,style:{padding:"15px"}},i.a.createElement(Te,{key:e.id,todolist:e,demo:a})))})))):i.a.createElement(Se.a,{to:"/login"})})),Le=a(181),we=a(163),xe=a(168),Pe=a(169),Fe=a(87),Ne=function(){var e=Object(C.b)(),t=Object(Fe.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",e.password?e.password.length<3&&(t.password="Password should contain more than 2 characters"):t.password="Required",t},onSubmit:function(a){var n;e((n=a,function(e){e(W("loading")),D(n).then((function(t){0===t.data.resultCode?(e(H(!0)),e(W("succeeded"))):_(t.data,e)})).catch((function(t){M(t,e)}))})),t.resetForm()}});return Object(C.c)((function(e){return e.auth.isLoggedIn}))?i.a.createElement(Se.a,{to:"/"}):i.a.createElement(re.a,{container:!0,justify:"center"},i.a.createElement(re.a,{item:!0,xs:4},i.a.createElement("form",{onSubmit:t.handleSubmit},i.a.createElement(Le.a,null,i.a.createElement(we.a,null,i.a.createElement("p",null,"To log in, please get registered",i.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank"}," here")),i.a.createElement("p",null,"or please use common test account credentials:"),i.a.createElement("p",null,"Email: free@samuraijs.com"),i.a.createElement("p",null,"Password: free")),i.a.createElement(xe.a,null,i.a.createElement(se.a,Object.assign({label:"*Email",margin:"normal",type:"email"},t.getFieldProps("email"))),t.touched.email&&t.errors.email?i.a.createElement("div",{style:{color:"red"}},t.errors.email):null,i.a.createElement(se.a,Object.assign({type:"password",label:"*Password",margin:"normal"},t.getFieldProps("password"))),t.touched.password&&t.errors.password?i.a.createElement("div",{style:{color:"red"}},t.errors.password):null,i.a.createElement(Pe.a,Object.assign({label:"Remember me",control:i.a.createElement(Oe.a,null)},t.getFieldProps("rememberMe"))),i.a.createElement(g.a,{type:"submit",variant:"contained",color:"primary"},"Login"))))))};var ze=function(e){var t=e.demo,a=void 0!==t&&t;console.log("App is called");var o=Object(C.c)((function(e){return e.app})),c=o.status,r=o.isInitialized,l=Object(C.c)((function(e){return e.auth.isLoggedIn})),d=Object(C.b)();Object(n.useEffect)((function(){d((function(e){z().then((function(t){0===t.data.resultCode?e(H(!0)):_(t.data,e),e(G(!0))})).catch((function(t){M(t,e)}))}))}),[]);var k=Object(n.useCallback)((function(){d((function(e){e(W("loading")),R().then((function(t){0===t.data.resultCode?(e(H(!1)),e(W("succeeded"))):_(t.data,e)})).catch((function(t){M(t,e)}))}))}),[d]);return r?i.a.createElement("div",null,i.a.createElement(V,null),i.a.createElement(m.a,{position:"static"},i.a.createElement(f.a,null,i.a.createElement(p.a,{edge:"start",color:"inherit","aria-label":"menu"},i.a.createElement(y.a,null)),i.a.createElement(b.a,{variant:"h6"},i.a.createElement("span",{style:{margin:"15px"}},"Notes")),l&&i.a.createElement(g.a,{color:"inherit",onClick:k},"Log out"))),i.a.createElement("div",{style:{position:"relative"}},"loading"===c&&i.a.createElement("div",{className:s.a.progress},i.a.createElement(E.a,{color:"secondary"}))),i.a.createElement(h.a,{fixed:!0},i.a.createElement(Se.d,null,i.a.createElement(Se.b,{exact:!0,path:"/",render:function(){return i.a.createElement(Ae,{demo:a})}}),i.a.createElement(Se.b,{path:"/login",render:function(){return i.a.createElement(Ne,null)}}),i.a.createElement(Se.b,{path:"/404",render:function(){return i.a.createElement("h1",null,"404: PAGE NOT FOUND")}}),i.a.createElement(Se.a,{from:"*",to:"/404"})))):i.a.createElement("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"}},i.a.createElement(u.a,null))},De=a(21),Re=a(48),_e=Object(De.c)({tasks:ge,todoLists:X,app:K,auth:B}),Me=Object(U.a)({reducer:_e,middleware:function(e){return e().prepend(Re.a)}});window.store=Me;var Ue=a(47);c.a.render(i.a.createElement(C.a,{store:Me},i.a.createElement(Ue.a,null,i.a.createElement(ze,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},79:function(e,t,a){e.exports={progress:"App_progress__3J7Qh"}},99:function(e,t,a){e.exports=a(127)}},[[99,1,2]]]);
//# sourceMappingURL=main.c22ed708.chunk.js.map